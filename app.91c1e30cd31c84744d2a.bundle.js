!function(){"use strict";var t={213:function(t,e,i){i.r(e)},844:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.App=void 0;var o=n(i(632)),a=i(648),r=function(){function t(){var t=this;this.worldSideSize=166,this.engine=new o.default(this.worldSideSize),this.canvas=document.createElement("canvas"),this.isStarted=!1,this.frameHeight=10,this.frameWidth=10,this.framePositionX=0,this.framePositionY=0,this.realMousePosition={x:0,y:0},this.virtualMousePosition={x:0,y:0},this.isPause=!1,this.canvas.classList.add("canvas-renderer");var e=document.body.querySelector(".app");e&&e.appendChild(this.canvas);var i=function(t,e){var i=t.getBoundingClientRect(),n=e.touches[0],o=t.width/i.width,a=t.height/i.height;return{x:(n.clientX-i.left)*o,y:(n.clientY-i.top)*a}},n=function(e){t.realMousePosition=e;var i=t.renderer.getPixelSize();t.virtualMousePosition.x=t.framePositionX+Math.floor(e.x/i),t.virtualMousePosition.y=t.framePositionY+(t.frameHeight-1-Math.floor(e.y/i)),t.engine.setMousedPosition(t.virtualMousePosition)};this.canvas.addEventListener("mousemove",(function(e){var i=function(t,e){var i=t.getBoundingClientRect(),n=t.width/i.width,o=t.height/i.height;return{x:(e.clientX-i.left)*n,y:(e.clientY-i.top)*o}}(t.canvas,e);n(i)}),!1),this.canvas.addEventListener("touchmove",(function(e){var o=i(t.canvas,e);n(o)}),!1),this.canvas.addEventListener("wheel",(function(e){-e.deltaY<0?t.engine.handleMouseWheelDown():-e.deltaY>0&&t.engine.handleMouseWheelUp()}),!1);var r,s,u,l,h;r=this.canvas,s=function(){return e=t.virtualMousePosition,t.engine.handleMouseLeftButton(e);var e},l=function(e){if("mousedown"===e.type&&e instanceof MouseEvent)0===e.button&&(u=window.setInterval(s,1));else if(e instanceof TouchEvent){var o=i(t.canvas,e);n(o),u=window.setInterval(s,1)}},h=function(){u&&window.clearInterval(u)},r.addEventListener("mousedown",l),r.addEventListener("mouseup",h),r.addEventListener("mouseout",h),r.addEventListener("touchstart",l),r.addEventListener("touchend",h),this.canvas.addEventListener("mousedown",(function(e){1===e.button&&t.engine.handleMouseMiddleButton()}),!1),document.addEventListener("keydown",(function(e){"ArrowRight"===e.key&&t.framePositionX<t.worldSideSize-t.frameWidth&&(t.framePositionX+=1),"ArrowLeft"===e.key&&t.framePositionX>0&&(t.framePositionX-=1),"ArrowUp"===e.key&&t.framePositionY<t.worldSideSize-t.frameHeight&&(t.framePositionY+=1),"ArrowDown"===e.key&&t.framePositionY>0&&(t.framePositionY-=1)," "===e.key&&(t.isPause=!t.isPause,t.engine.setPause(t.isPause)),"s"===e.key&&t.engine.saveToLocalStorage(),"l"===e.key&&t.engine.loadFromLocalStorage()})),this.renderer=new a.Renderer(this.canvas)}return t.prototype.setScreenSize=function(t,e){this.renderer.setScreenSize(t,e);var i=Math.floor(t/this.renderer.getPixelSize()),n=Math.floor(e/this.renderer.getPixelSize());this.engine.setRendererSize(i,n),this.frameWidth=Math.floor(i),this.frameHeight=Math.floor(n)},t.prototype.setPixelSize=function(t){this.renderer.setPixelSize(t);var e=Math.floor(this.renderer.getScreenSizeX()/this.renderer.getPixelSize()),i=Math.floor(this.renderer.getScreenSizeY()/this.renderer.getPixelSize());console.error(e,i),this.engine.setRendererSize(e,i),this.frameWidth=e,this.frameHeight=i},t.prototype.start=function(){this.isStarted||(this.renderer.getPixels().fill(4278190080),this.isStarted=!0,this.startRender())},t.prototype.startRender=function(){var t=this,e=function(i){t.renderer.setPixels(t.engine.requestFrame(t.frameWidth,t.frameHeight,t.framePositionX,t.framePositionY)),t.renderer.render(i),window.requestAnimationFrame(e)};e(0)},t}();e.App=r},632:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(i(575)),a=i(794),r=n(i(199)),s=i(283),u=function(){function t(t){var e=this;this.frameWidth=0,this.frameHeight=0,this.framePositionX=0,this.framePositionY=0,this.physicEngine=new o.default,this.worldSquareSide=2,this.mousePosition={x:0,y:0},this.lastUnitId=0,this.save="",this.isPhysicsEnginePause=!1,this.unitCreationType=0,this.unitCreationSquareSize=0,this.gameMaxCountMaterials=9,this.ui=new a.UI({}),this.gameWorldState=Array.from(Array(4),(function(){return new Array(4)})),this.worldSquareSide=t;for(var i=new Array(t),n=new Array(t),r=0;r<t;r++)n[r]=null;for(r=0;r<i.length;r++)i[r]=n.slice(0);this.gameWorldState=i;var s={"switch-create-pure-water":function(){e.unitCreationType=0},"switch-create-yellow-sand":function(){e.unitCreationType=1},"switch-create-gray-rock":function(){e.unitCreationType=2},"switch-create-flammable-gas":function(){e.unitCreationType=3},"switch-create-red-blood":function(){e.unitCreationType=4},"switch-create-black-oil":function(){e.unitCreationType=6},"switch-create-rock-hard":function(){e.unitCreationType=8},"switch-create-wood-wall":function(){e.unitCreationType=9},"switch-remove":function(){e.unitCreationType=5},"switch-ignite":function(){e.unitCreationType=7},"default-action":function(){return e.mainAction()}};this.ui=new a.UI(s)}return t.prototype.setPause=function(t){this.isPhysicsEnginePause=t},t.prototype.setMousedPosition=function(t){this.mousePosition=t,this.ui.setMousedPosition(t)},t.prototype.setRendererSize=function(t,e){this.frameWidth=t,this.frameHeight=e,this.ui.setRendererSize(t,e)},t.prototype.extractFrame=function(t,e,i,n){for(var o,a=this.ui.extractFrame(),r=new Uint32Array(t*e),u=(e-1)*t,l=n;l<n+e;l+=1){for(var h=i;h<i+t;h+=1){var d=a[h-i][l-n];if(null!==this.gameWorldState[h][l]||d){var f=null;if(null!==this.gameWorldState[h][l]&&(null===(o=this.gameWorldState[h][l])||void 0===o?void 0:o.unitState)){var c=this.gameWorldState[h][l].unitState.unitColor,m=this.gameWorldState[h][l].unitState.unitDecalColor;f=m&&0!==m?Number((0,s.mixColors)(c,m)):c}if(null!=d){var y=d.color;f=Number((0,s.mixColors)(f||0,y))}f&&(r[u]=f)}u+=1}u-=2*t}return r},t.prototype.handleMouseLeftButton=function(t){this.mousePosition=t,this.ui.handleClick(t)},t.prototype.mainAction=function(){this.createUnitAtPoint(this.mousePosition,this.unitCreationType,this.unitCreationSquareSize)},t.prototype.handleMouseWheelUp=function(){this.unitCreationSquareSize<2*this.frameHeight&&(this.unitCreationSquareSize+=1)},t.prototype.handleMouseWheelDown=function(){this.unitCreationSquareSize>0&&(this.unitCreationSquareSize-=1)},t.prototype.handleMouseMiddleButton=function(){this.unitCreationType<this.gameMaxCountMaterials?this.unitCreationType+=1:this.unitCreationType=0},t.prototype.createUnitAtPoint=function(t,e,i){var n,o,a=function(){var t="pure-water";switch(e){case 0:t="pure-water";break;case 1:t="yellow-sand";break;case 2:t="gray-rock";break;case 3:t="flammable-gas";break;case 4:t="red-blood";break;case 5:return null;case 6:t="black-oil";break;case 7:return"set-on-fire";case 8:t="rock-hard";break;case 9:t="wood-wall"}return new r.default(t,null,0)};if(i>0)for(var s=Math.floor(t.x/i)*i,u=Math.floor(t.y/i)*i,l=0;l<i;l+=1)for(var h=0;h<i;h+=1){var d=a();s+h<this.worldSquareSide&&u+l<this.worldSquareSide&&("set-on-fire"===d?this.gameWorldState[s+h][u+l]&&(null===(n=this.gameWorldState[s+h][u+l])||void 0===n?void 0:n.getUnitType().unitIsFlammable)&&(this.gameWorldState[s+h][u+l].unitState.unitIsOnFire=!0):this.gameWorldState[s+h][u+l]&&null!==d||(this.gameWorldState[s+h][u+l]=d,null!==d&&(d.unitId=this.lastUnitId++)))}else{var f=a();"set-on-fire"===f?this.gameWorldState[t.x][t.y]&&(null===(o=this.gameWorldState[t.x][t.y])||void 0===o?void 0:o.getUnitType().unitIsFlammable)&&(this.gameWorldState[t.x][t.y].unitState.unitIsOnFire=!0):this.gameWorldState[t.x][t.y]&&null!==f||(this.gameWorldState[t.x][t.y]=f,null!==f&&(f.unitId=this.lastUnitId++))}},t.prototype.requestFrame=function(t,e,i,n){return this.isPhysicsEnginePause||(this.gameWorldState=this.physicEngine.resolveWorld(this.gameWorldState,this.worldSquareSide)),this.extractFrame(t,e,i,n)},t.prototype.convertWorldStateToSave=function(){for(var t={},e=0;e<this.worldSquareSide;e+=1)for(var i=0;i<this.worldSquareSide;i+=1)null!=this.gameWorldState[e][i]&&(t[e]||(t[e]={}),t[e][i]=this.gameWorldState[e][i]);return t},t.prototype.serializeToSaveFile=function(){var t={frameWidth:this.frameWidth,frameHeight:this.frameHeight,framePositionX:this.framePositionX,framePositionY:this.framePositionY,worldSideSize:this.worldSquareSide,lastUnitId:this.lastUnitId,worldSate:this.convertWorldStateToSave()};return console.error(t),this.save=JSON.stringify(t),JSON.stringify(t)},t.prototype.convertSaveToWorldState=function(t,e){var i=Array.from(Array(e),(function(){return new Array(e)}));return Object.keys(t).forEach((function(e){t[parseInt(e,10)]&&Object.keys(t[parseInt(e,10)]).forEach((function(n){if(t[parseInt(e,10)][parseInt(n,10)]){var o=t[parseInt(e,10)][parseInt(n,10)],a=new r.default(o.unitTypeName,null,o.unitId,o.unitState);i[parseInt(e,10)][parseInt(n,10)]=a}}))})),i},t.prototype.deserializeAnLoadFromFile=function(t){void 0===t&&(t=this.save);var e=JSON.parse(t);if(t&&"{"===t[0]){var i=Object.keys(e).length;e&&i>0&&e.worldSate&&(this.frameWidth=e.frameWidth,this.frameHeight=e.frameHeight,this.framePositionX=e.framePositionX,this.framePositionY=e.framePositionY,this.worldSquareSide=e.worldSideSize,this.lastUnitId=e.lastUnitId,this.gameWorldState=this.convertSaveToWorldState(e.worldSate,e.worldSideSize))}},t.prototype.saveToLocalStorage=function(){localStorage.setItem("pws-save",this.serializeToSaveFile())},t.prototype.loadFromLocalStorage=function(){var t=localStorage.getItem("pws-save");t&&this.deserializeAnLoadFromFile(t)},t}();e.default=u},575:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=i(283),o=function(){function t(){this.lastY=0,this.isLineByLineResolve=!1}return t.prototype.resolveWorld=function(t,e){for(var i,o=function(e,i,n,o,a){void 0===a&&(a=!0);var r=t[n][o];t[n][o]=t[e][i],t[n][o]&&(t[n][o].isUpdated=a),t[e][i]=r,t[e][i]&&(t[e][i].isUpdated=a)},a=function(i,n,a,r,s){if(void 0===s&&(s=!0),t[a][r]){var u=function(i,n,a){var r=function(a){return t[i][n+a]?i>0&&!t[i-1][n+a]?(o(i,n,i-1,n+a),!0):i<e-1&&!t[i+1][n+a]&&(o(i,n,i+1,n+a),!0):(o(i,n,i,n+a),!0)},s=a?-1:1;if(n>0){if(r(1*s))return!0}else{if(i>0&&!t[i-1][n])return o(i,n,i-1,n),!0;if(i<e-1&&!t[i+1][n])return o(i,n,i+1,n),!0;if(n<e-1&&r(-1*s))return!0}return!1}(a,r,t[a][r].getUnitType().unitIsLiquid);u||o(i,n,a,r,s)}else o(i,n,a,r,s)},r=function(i,o){var a=0;(0,n.getRandomInt)(0,100)>=30&&(a=4278190335+(0,n.getRandomInt)(0,233)*Math.pow(16,2));t[i][o].unitState.unitDecalColor=a,t[i][o].unitState.fireHP-=1;var r=function(i,o){var a,r;if(function(t,i){return t>=0&&t<e&&i>=0&&i<e}(i,o)&&t[i][o]&&(null===(a=t[i][o])||void 0===a?void 0:a.getUnitType().unitIsFlammable)){if(t[i][o].unitState.unitIsOnFire)return;if(t[i][o].unitState.flameSustainability<=1)(0,n.getRandomInt)(0,1e3)>=1e3-((null===(r=t[i][o])||void 0===r?void 0:r.getUnitType().unitDefaultFlameSustainability)||0)&&(t[i][o].unitState.unitIsOnFire=!0);else t[i][o].unitState.flameSustainability-=1}};r(i-1,o),r(i+1,o),r(i,o+1),r(i,o-1)},s=function(i,r){var s,u,l;(null===(s=t[i][r])||void 0===s?void 0:s.isUpdated)||((null===(u=t[i][r])||void 0===u?void 0:u.getUnitType().unitIsGas)?function(i,a){var r=i>0&&!t[i-1][a],s=i<e-1&&!t[i+1][a];if(a<=e-1){var u=!t[i][a+1],l=i>0&&!t[i-1][a+1],h=i<e-1&&!t[i+1][a+1],d=l&&h,f=r&&s;if(u)o(i,a,i,a+1);else if(d&&f){var c=(0,n.getRandomInt)(0,1);o(i,a,0===c?i-1:i+1,a+1)}else l&&r?o(i,a,i-1,a+1):h&&s?o(i,a,i+1,a+1):r?o(i,a,i-1,a):s&&o(i,a,i+1,a)}else a===e-1&&(r?o(i,a,i-1,a):s&&o(i,a,i+1,a))}(i,r):(null===(l=t[i][r])||void 0===l?void 0:l.getUnitType().unitIsLiquid)?function(i,a){var r,s,u,l,h,d,f,c,m,y,p=i>0&&!t[i-1][a],v=i>0&&!p&&!p&&(null===(r=t[i-1][a])||void 0===r?void 0:r.isUpdated),g=i>0&&!p&&(null===(s=t[i-1][a])||void 0===s?void 0:s.getUnitType().unitIsLiquid)&&t[i-1][a].getUnitType().unitDensity<t[i][a].getUnitType().unitDensity,S=i>0&&!p&&(null===(u=t[i-1][a])||void 0===u?void 0:u.getUnitType().unitIsGas),w=i<e-1&&!t[i+1][a],I=i<e-1&&!w&&(null===(l=t[i+1][a])||void 0===l?void 0:l.isUpdated),T=i<e-1&&!w&&(null===(h=t[i+1][a])||void 0===h?void 0:h.getUnitType().unitIsLiquid)&&t[i+1][a].getUnitType().unitDensity<t[i][a].getUnitType().unitDensity,b=i<e-1&&!w&&(null===(d=t[i+1][a])||void 0===d?void 0:d.getUnitType().unitIsGas);if(a>0){var C=!t[i][a-1],P=!C&&(null===(f=t[i][a-1])||void 0===f?void 0:f.getUnitType().unitIsLiquid)&&t[i][a-1].getUnitType().unitDensity<t[i][a].getUnitType().unitDensity,U=!C&&(null===(c=t[i][a-1])||void 0===c?void 0:c.getUnitType().unitIsGas),D=i>0&&!t[i-1][a-1],x=i>0&&!D&&t[i-1][a-1].getUnitType().unitIsLiquid&&t[i-1][a-1].getUnitType().unitDensity<t[i][a].getUnitType().unitDensity,F=i>0&&!D&&t[i-1][a-1].getUnitType().unitIsGas,z=i>0&&!D&&(null===(m=t[i-1][a-1])||void 0===m?void 0:m.isUpdated),M=i<e-1&&!t[i+1][a-1],R=i<e-1&&!M&&t[i+1][a-1].getUnitType().unitIsLiquid&&t[i+1][a-1].getUnitType().unitDensity<t[i][a].getUnitType().unitDensity,L=i<e-1&&!M&&t[i+1][a-1].getUnitType().unitIsGas,q=i<e-1&&!M&&(null===(y=t[i+1][a-1])||void 0===y?void 0:y.isUpdated),W=D&&M,H=x&&R,N=F&&L,k=p&&w,A=v&&I,B=g&&T,_=S&&b;if(C||P||U)o(i,a,i,a-1);else if(!A&&(W||H||N)&&(k||B||_)){var O=(0,n.getRandomInt)(0,1);o(i,a,0===O?i-1:i+1,a-1)}else!z&&(D||x||F)&&(p||g||S)?o(i,a,i-1,a-1):!q&&(M||R||L)&&(w||T||b)?o(i,a,i+1,a-1):!v&&(p||g||S)?o(i,a,i-1,a):!I&&(w||T||b)&&o(i,a,i+1,a)}else 0===a&&(!v&&(p||g||S)?o(i,a,i-1,a):!I&&(w||T||b)&&o(i,a,i+1,a))}(i,r):function(i,r){var s,u,l,h,d,f,c,m,y,p;if(!(r<=0)){var v=!1,g=!1,S=!1,w=!1,I=!1,T=!1,b=!1,C=!1,P=!1,U=!1,D=!1,x=!1;i>0&&((v=!t[i-1][r])||(g=!!(null===(s=t[i-1][r])||void 0===s?void 0:s.getUnitType().unitIsLiquid),S=!!(null===(u=t[i-1][r])||void 0===u?void 0:u.getUnitType().unitIsGas)),(b=!t[i-1][r-1])||(C=!!(null===(l=t[i-1][r-1])||void 0===l?void 0:l.getUnitType().unitIsLiquid),P=!!(null===(h=t[i-1][r-1])||void 0===h?void 0:h.getUnitType().unitIsGas))),i<e-1&&((w=!t[i+1][r])||(I=!!(null===(d=t[i+1][r])||void 0===d?void 0:d.getUnitType().unitIsLiquid),T=!!(null===(f=t[i+1][r])||void 0===f?void 0:f.getUnitType().unitIsGas)),(U=!t[i+1][r-1])||(D=!!(null===(c=t[i+1][r-1])||void 0===c?void 0:c.getUnitType().unitIsLiquid),x=!!(null===(m=t[i+1][r-1])||void 0===m?void 0:m.getUnitType().unitIsGas)));var F=t[i][r-1]&&((null===(y=t[i][r-1])||void 0===y?void 0:y.getUnitType().unitIsLiquid)||(null===(p=t[i][r-1])||void 0===p?void 0:p.getUnitType().unitIsGas)),z=v||g||S,M=w||I||T,R=b||C||P,L=U||D||x,q=R&&L,W=z&&M;if(!t[i][r-1]||F)F?r<e-1&&a(i,r,i,r-1):t[i][r-1]||o(i,r,i,r-1);else if(q&&W){var H=(0,n.getRandomInt)(0,1);a(i,r,0===H?i-1:i+1,r-1)}else R&&z?a(i,r,i-1,r-1):L&&M&&a(i,r,i+1,r-1)}}(i,r))},u=function(e,i){var n,o,a,u,l;null!=t[e][i]&&((null===(n=t[e][i])||void 0===n?void 0:n.getUnitType().unitIsStatic)||s(e,i),(null===(o=t[e][i])||void 0===o?void 0:o.unitState.unitIsOnFire)&&r(e,i),t[e][i]&&(null===(a=t[e][i])||void 0===a?void 0:a.unitState)&&t[e][i].unitState.unitHealth<=0&&(t[e][i]=null),t[e][i]&&(null===(u=t[e][i])||void 0===u?void 0:u.getUnitType().unitIsFlammable)&&(null===(l=t[e][i])||void 0===l?void 0:l.unitState)&&t[e][i].unitState.fireHP<=0&&(t[e][i]=null))},l=0;l<e;l+=1)for(var h=0;h<e;h+=1)null!=t[h][l]&&((null===(i=t[h][l])||void 0===i?void 0:i.getUnitType().unitIsStatic)||(t[h][l].isUpdated=!1));var d=function(t){if(!1===Boolean((0,n.getRandomInt)(0,1)))for(var i=0;i<e;i+=1)u(i,t);else for(i=e-1;i>=0;i-=1)u(i,t)};if(this.isLineByLineResolve){l=0;this.lastY<e?l=this.lastY++:this.lastY=0,d(l)}else for(l=0;l<e;l+=1)d(l);return t},t}();e.default=o},648:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var i=function(){function t(t){var e=this;this.pixelSize=1,this.wallColor=4278190080,this.lastFrameTime=(new Date).getTime(),this.getScreenSizeX=function(){return e.width},this.getScreenSizeY=function(){return e.height},this.getPixelsCount=function(){return e.width*e.height/Math.pow(e.pixelSize,2)},this.getPixelSize=function(){return e.pixelSize},this.getLastFrameTime=function(){return e.lastFrameTime},this.canvas=t,this.width=this.canvas.width,this.height=this.canvas.height,this.desiredWidth=this.canvas.width,this.desiredHeight=this.canvas.height,this.ctx=this.canvas.getContext("2d")||new CanvasRenderingContext2D,this.imageData=this.ctx.createImageData(this.width,this.height),this.realPixels=new Uint32Array(this.imageData.data.buffer),this.virtualPixels=new Uint32Array(this.width/this.pixelSize*(this.height/this.pixelSize))}return t.prototype.setScreenSize=function(t,e){this.desiredWidth=t,this.desiredHeight=e,this.width=Math.floor(t/this.pixelSize)*this.pixelSize,this.height=Math.floor(e/this.pixelSize)*this.pixelSize,this.canvas.width=this.width,this.canvas.height=this.height,this.imageData=this.ctx.createImageData(this.width,this.height),this.realPixels=new Uint32Array(this.imageData.data.buffer),this.virtualPixels=new Uint32Array(this.width/this.pixelSize*(this.height/this.pixelSize))},t.prototype.setPixelSize=function(t){this.pixelSize=t,this.setScreenSize(this.desiredWidth,this.desiredHeight)},t.prototype.render=function(t){for(var e=function(t,e,i,n){return(n-e-1)*i+t},i=0;i<this.height/this.pixelSize;i++)for(var n=0;n<this.width/this.pixelSize;n++)for(var o=0;o<this.pixelSize;o++)for(var a=0;a<this.pixelSize;a++){var r=e(n*this.pixelSize+o,i*this.pixelSize+a,this.width,this.height),s=e(n,i,this.width/this.pixelSize,this.height/this.pixelSize);this.realPixels[r]=this.virtualPixels[s]}this.ctx.putImageData(this.imageData,0,0),1e3/(performance.now()-this.lastFrameTime)==1/0&&(this.lastFrameTime=performance.now()),this.ctx.font="10px serif",this.ctx.fillStyle="red",this.ctx.fillText("FPS: ".concat(String(1e3/(performance.now()-this.lastFrameTime))),0,10),this.lastFrameTime=performance.now()},t.prototype.getPixels=function(){return this.virtualPixels},t.prototype.setPixels=function(t){this.virtualPixels=t},t}();e.Renderer=i},794:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.UI=void 0;var n=i(281),o=function(){function t(t){this.frameWidth=1,this.frameHeight=1,this.mousePosition={x:0,y:0},this.UIState=Array.from(Array(1),(function(){return new Array(1)})),this.actions={},this.actions=t}return t.prototype.setRendererSize=function(t,e){this.frameWidth=t,this.frameHeight=e},t.prototype.setMousedPosition=function(t){this.mousePosition=t},t.prototype.dispatchAction=function(t){var e=this.actions[t];e&&e()},t.prototype.drawCursor=function(){this.mousePosition.x+1<this.frameWidth&&(this.UIState[this.mousePosition.x+1][this.mousePosition.y]={color:4278190080,actionType:null}),this.mousePosition.x-1>0&&(this.UIState[this.mousePosition.x-1][this.mousePosition.y]={color:4278190080,actionType:null}),this.mousePosition.y+1<this.frameHeight&&(this.UIState[this.mousePosition.x][this.mousePosition.y+1]={color:4278190080,actionType:null}),this.mousePosition.y-1>0&&(this.UIState[this.mousePosition.x][this.mousePosition.y-1]={color:4278190080,actionType:null})},t.prototype.drawRectangle=function(t,e,i,n,o){var a=e+n,r=i+o;if(e<this.frameWidth&&i<this.frameHeight&&e>=0&&i>=0)for(var s=e;s<this.frameWidth&&s<=a;s+=1)for(var u=i;u<this.frameHeight&&u<=r;u+=1)this.UIState[s][u]=t},t.prototype.drawCreationMenu=function(){var t={color:(0,n.getUnitTypeByUnitTypeName)("pure-water").unitDefaultColor.baseColor,actionType:"switch-create-pure-water"},e={color:(0,n.getUnitTypeByUnitTypeName)("yellow-sand").unitDefaultColor.baseColor,actionType:"switch-create-yellow-sand"},i={color:(0,n.getUnitTypeByUnitTypeName)("gray-rock").unitDefaultColor.baseColor,actionType:"switch-create-gray-rock"},o={color:(0,n.getUnitTypeByUnitTypeName)("flammable-gas").unitDefaultColor.baseColor,actionType:"switch-create-flammable-gas"},a={color:(0,n.getUnitTypeByUnitTypeName)("red-blood").unitDefaultColor.baseColor,actionType:"switch-create-red-blood"},r={color:(0,n.getUnitTypeByUnitTypeName)("black-oil").unitDefaultColor.baseColor,actionType:"switch-create-black-oil"},s={color:(0,n.getUnitTypeByUnitTypeName)("rock-hard").unitDefaultColor.baseColor,actionType:"switch-create-rock-hard"},u={color:(0,n.getUnitTypeByUnitTypeName)("wood-wall").unitDefaultColor.baseColor,actionType:"switch-create-wood-wall"},l={color:(0,n.getUnitTypeByUnitTypeName)("yellow-flame").unitDefaultColor.baseColor,actionType:"switch-ignite"};this.drawRectangle(t,160,120,4,4),this.drawRectangle(e,160,112,4,4),this.drawRectangle(i,160,104,4,4),this.drawRectangle(o,160,96,4,4),this.drawRectangle(a,160,88,4,4),this.drawRectangle(r,160,80,4,4),this.drawRectangle(s,160,72,4,4),this.drawRectangle(u,160,64,4,4),this.drawRectangle({color:4278190335,actionType:"switch-remove"},160,56,4,4),this.drawRectangle(l,160,48,4,4)},t.prototype.drawUI=function(){this.drawCreationMenu(),this.drawCursor()},t.prototype.handleClick=function(t){var e;this.mousePosition=t;var i=null===(e=this.UIState[t.x][t.y])||void 0===e?void 0:e.actionType;console.log(this.UIState),i?this.dispatchAction(i):this.dispatchAction("default-action")},t.prototype.extractFrame=function(){for(var t=new Array(this.frameWidth),e=new Array(this.frameHeight),i=0;i<this.frameHeight;i++)e[i]=null;for(i=0;i<t.length;i++)t[i]=e.slice(0);return this.UIState=t,this.drawUI(),this.UIState},t}();e.UI=o},199:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=i(281),o=i(283),a=function(){function t(t,e,i,a){if(void 0===e&&(e=null),void 0===i&&(i=0),void 0===a&&(a=null),this.isUpdated=!1,this.unitTypeName=t,this.unitVelocityVector=e,this.unitId=i,a)this.unitState=a;else{var r=(0,n.getUnitTypeByUnitTypeName)(t),s=r.unitDefaultColor,u=(0,o.getRandomInt)(s.minRandomColor,s.maxRandomColor),l=(15&s.colorShiftNumbers)>>3,h=(240&s.colorShiftNumbers)>>4>>3,d=(3840&s.colorShiftNumbers)>>8>>3,f=u*l+u*Math.pow(16,2)*h+u*Math.pow(16,4)*d,c=s.baseColor+f;this.unitState={unitHealth:r.unitDefaultHealth,unitIsOnFire:!1,unitColor:c,unitDecalColor:0,flameSustainability:r.unitDefaultFlameSustainability,fireHP:r.unitDefaultFireHP}}}return t.prototype.getUnitType=function(){return(0,n.getUnitTypeByUnitTypeName)(this.unitTypeName)},t}();e.default=a},281:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getUnitTypeByUnitTypeName=e.UnitTypesArray=e.UnitTypesStringsToIndex=void 0,e.UnitTypesStringsToIndex={"yellow-sand":0,"pure-water":1,"gray-rock":2,"flammable-gas":3,"red-blood":4,"yellow-flame":5,"gray-smoke":6,"black-oil":7,"rock-hard":8,"wood-wall":9},e.UnitTypesArray=[{unitName:"yellow-sand",unitIsLiquid:!1,unitIsStatic:!1,unitIsGas:!1,unitIsFlammable:!1,unitDefaultFlameSustainability:1,unitDefaultFireHP:0,unitDefaultHealth:800,unitDurability:4,unitDensity:1.5,unitDefaultColor:{minRandomColor:0,maxRandomColor:20,colorShiftNumbers:4095,baseColor:4278242795},unitTransformations:{toFreeze:"yellow-sand",toLiquid:"molten-glass",toVapor:null,toDestroy:null,toCorrode:null}},{unitName:"pure-water",unitIsLiquid:!0,unitIsStatic:!1,unitIsGas:!1,unitIsFlammable:!1,unitDefaultFlameSustainability:1,unitDefaultFireHP:0,unitDefaultHealth:10,unitDurability:0,unitDensity:1,unitDefaultColor:{minRandomColor:0,maxRandomColor:0,colorShiftNumbers:4095,baseColor:2013255936},unitTransformations:{toFreeze:"pure-ice",toLiquid:"pure-water",toVapor:"water-steam",toDestroy:"water-steam",toCorrode:"water-steam"}},{unitName:"gray-rock",unitIsLiquid:!1,unitIsStatic:!0,unitIsGas:!1,unitIsFlammable:!1,unitDefaultFlameSustainability:3,unitDefaultFireHP:0,unitDefaultHealth:100,unitDurability:0,unitDensity:2.6,unitDefaultColor:{minRandomColor:10,maxRandomColor:82,colorShiftNumbers:4095,baseColor:4286677377},unitTransformations:{toFreeze:null,toLiquid:"molten-rock",toVapor:null,toDestroy:null,toCorrode:null}},{unitName:"flammable-gas",unitIsLiquid:!1,unitIsStatic:!1,unitIsGas:!0,unitIsFlammable:!0,unitDefaultFlameSustainability:3,unitDefaultFireHP:200,unitDefaultHealth:10,unitDurability:0,unitDensity:.00182,unitDefaultColor:{minRandomColor:10,maxRandomColor:82,colorShiftNumbers:4095,baseColor:856795648},unitTransformations:{toFreeze:null,toLiquid:"flammable-liquid",toVapor:null,toDestroy:null,toCorrode:null}},{unitName:"red-blood",unitIsLiquid:!0,unitIsStatic:!1,unitIsGas:!1,unitIsFlammable:!1,unitDefaultFlameSustainability:1,unitDefaultFireHP:0,unitDefaultHealth:10,unitDurability:0,unitDensity:1.03,unitDefaultColor:{minRandomColor:0,maxRandomColor:0,colorShiftNumbers:4095,baseColor:2852257923},unitTransformations:{toFreeze:"frozen-red-blood",toLiquid:null,toVapor:null,toDestroy:null,toCorrode:null}},{unitName:"yellow-flame",unitIsLiquid:!1,unitIsStatic:!1,unitIsGas:!0,unitIsFlammable:!1,unitDefaultFlameSustainability:1,unitDefaultFireHP:3,unitDefaultHealth:3,unitDurability:0,unitDensity:33e-5,unitDefaultColor:{minRandomColor:10,maxRandomColor:53,colorShiftNumbers:4095,baseColor:2130731263},unitTransformations:{toFreeze:null,toLiquid:null,toVapor:null,toDestroy:"gray-smoke",toCorrode:null}},{unitName:"gray-smoke",unitIsLiquid:!1,unitIsStatic:!1,unitIsGas:!0,unitIsFlammable:!1,unitDefaultFlameSustainability:1,unitDefaultFireHP:0,unitDefaultHealth:10,unitDurability:0,unitDensity:61e-5,unitDefaultColor:{minRandomColor:10,maxRandomColor:82,colorShiftNumbers:4095,baseColor:856795648},unitTransformations:{toFreeze:null,toLiquid:null,toVapor:null,toDestroy:null,toCorrode:null}},{unitName:"black-oil",unitIsLiquid:!0,unitIsStatic:!1,unitIsGas:!1,unitIsFlammable:!0,unitDefaultFlameSustainability:10,unitDefaultFireHP:500,unitDefaultHealth:1e3,unitDurability:0,unitDensity:.88,unitDefaultColor:{minRandomColor:0,maxRandomColor:20,colorShiftNumbers:15,baseColor:4278190080},unitTransformations:{toFreeze:null,toLiquid:null,toVapor:null,toDestroy:"gray-smoke",toCorrode:null}},{unitName:"rock-hard",unitIsLiquid:!1,unitIsStatic:!0,unitIsGas:!1,unitIsFlammable:!1,unitDefaultFlameSustainability:0,unitDefaultFireHP:0,unitDefaultHealth:2e5,unitDurability:12,unitDensity:.88,unitDefaultColor:{minRandomColor:0,maxRandomColor:20,colorShiftNumbers:4095,baseColor:4280492926},unitTransformations:{toFreeze:null,toLiquid:null,toVapor:null,toDestroy:null,toCorrode:null}},{unitName:"wood-wall",unitIsLiquid:!1,unitIsStatic:!0,unitIsGas:!1,unitIsFlammable:!0,unitDefaultFlameSustainability:100,unitDefaultFireHP:600,unitDefaultHealth:2e3,unitDurability:10,unitDensity:.88,unitDefaultColor:{minRandomColor:0,maxRandomColor:20,colorShiftNumbers:15,baseColor:4279859366},unitTransformations:{toFreeze:null,toLiquid:null,toVapor:null,toDestroy:null,toCorrode:null}}];e.getUnitTypeByUnitTypeName=function(t){var i=e.UnitTypesStringsToIndex[t];return e.UnitTypesArray[i]}},283:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.mixColors=e.getRandomInt=void 0;e.getRandomInt=function(t,e){var i=Math.ceil(t),n=Math.floor(e);return Math.floor(Math.random()*(n-i+1))+i};e.mixColors=function(t,e){var i=Number(BigInt(e)>>BigInt(24));if(255===i)return e;var n=Number(BigInt(t)>>BigInt(24))/255,o=i/255,a=Number(BigInt(t)&BigInt(16777215)),r=Number(BigInt(e)&BigInt(16777215)),s=(1-n)*o+n,u=function(t,e,i,n,o){return Math.round(((1-i)*n*e+i*t)/o)},l=(65280&a)>>8,h=(16711680&a)>>16,d=(65280&r)>>8,f=(16711680&r)>>16,c=u(255&a,255&r,n,o,s),m=u(l,d,n,o,s),y=(u(h,f,n,o,s)<<16)+(m<<8)+c;return(BigInt(Math.round(255*s))<<BigInt(24))+BigInt(y)}}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,i),a.exports}i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};!function(){i(213);var t=new(i(844).App);t.setScreenSize(1e3,1e3),t.setPixelSize(6),t.start()}()}();